<!DOCTYPE html>
<html lang="bn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assign Modal</title>

    <!-- Material UI CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-roboto/0.10.2/font-roboto.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/material-design-icons/4.0.0/iconfont/material-icons.min.css">

    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Material UI -->
    <script src="https://unpkg.com/@mui/material@5.15.15/umd/material-ui.development.js"></script>

    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }

        #root {
            max-width: 1200px;
            margin: 0 auto;
        }

        .price-breakdown {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            border-left: 4px solid #2196f3;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        const {
            Dialog,
            DialogTitle,
            DialogContent,
            DialogActions,
            Button,
            TextField,
            Select,
            MenuItem,
            FormControl,
            InputLabel,
            Typography,
            Box,
            Grid,
            Card,
            CardContent,
            ThemeProvider,
            createTheme
        } = MaterialUI;

        // Create theme
        const theme = createTheme({
            palette: {
                primary: {
                    main: '#1976d2',
                },
                secondary: {
                    main: '#dc004e',
                },
            },
        });

        // Sample data
        const sampleUsers = [
            { id: 1, name: '‡¶ú‡¶® ‡¶°‡ßã', email: 'john@example.com' },
            { id: 2, name: '‡¶ú‡ßá‡¶® ‡¶∏‡ßç‡¶Æ‡¶ø‡¶•', email: 'jane@example.com' },
            { id: 3, name: '‡¶Æ‡¶æ‡¶π‡¶Æ‡ßÅ‡¶¶ ‡¶π‡¶æ‡¶∏‡¶æ‡¶®', email: 'mahmud@example.com' },
            { id: 4, name: '‡¶´‡¶æ‡¶§‡¶ø‡¶Æ‡¶æ ‡¶ñ‡¶æ‡¶®', email: 'fatima@example.com' }
        ];

        const packageTypes = [
            { id: 1, name: '‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú' },
            { id: 2, name: '‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú' },
            { id: 3, name: '‡¶°‡¶ø‡¶≤‡¶æ‡¶ï‡ßç‡¶∏ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú' },
            { id: 4, name: '‡¶∏‡ßç‡¶™‡ßá‡¶∂‡¶æ‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú' }
        ];

        const packageIds = [
            { id: 'PKG001', packagetypeid: "packagetypeid", name: '‡¶õ‡¶æ‡¶§‡ßç‡¶∞ ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú' },
            { id: 'PKG002', packagetypeid: "packagetypeid", name: '‡¶õ‡¶æ‡¶§‡ßç‡¶∞ ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡ßü‡¶æ‡¶Æ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú' },
            { id: 'PKG003', packagetypeid: "packagetypeid", name: '‡¶ü‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú' },
            { id: 'PKG004', packagetypeid: "packagetypeid", name: '‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶´ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú' }
        ];

        const meals = [
            { id: 1, name: 'Student Complete Day Package', price: 250 },
            { id: 2, name: 'Premium Teacher Full Day Package', price: 350 },
            // { id: 3, name: '‡¶≠‡ßá‡¶ú‡¶ø‡¶ü‡ßá‡¶¨‡¶≤ ‡¶•‡¶æ‡¶≤‡¶ø', price: 180 },
            // { id: 4, name: '‡¶´‡¶ø‡¶∂ ‡¶´‡ßç‡¶∞‡¶æ‡¶á', price: 220 },
            // { id: 5, name: '‡¶¨‡¶ø‡¶´ ‡¶∞‡ßã‡¶∏‡ßç‡¶ü', price: 400 },
            // { id: 6, name: '‡¶ö‡¶ø‡¶ï‡ßá‡¶® ‡¶ï‡ßã‡¶∞‡¶Æ‡¶æ', price: 280 }
        ];

        function AssignModal() {
            const [open, setOpen] = useState(false);
            const [formData, setFormData] = useState({
                assignUser: 1,
                packageType: '',
                packageId: '',
                meal: '',
                discount: 0,
                price: 0
            });

            const selectedMeal = meals.find(meal => meal.id === formData.meal);
            const originalPrice = selectedMeal ? selectedMeal.price : 0;
            const discountAmount = (originalPrice * formData.discount) / 100;
            const finalPrice = originalPrice - discountAmount;

            // const handleInputChange = (field, value) => {
            //     const newFormData = { ...formData, [field]: value };

            //     if (field === 'meal') {
            //         const meal = meals.find(m => m.id === value);
            //         const mealPrice = meal ? meal.price : 0;
            //         const discountAmt = (mealPrice * formData.discount) / 100;
            //         newFormData.price = mealPrice - discountAmt;
            //     } else if (field === 'discount') {
            //         const discountAmt = (originalPrice * value) / 100;
            //         newFormData.price = originalPrice - discountAmt;
            //     }

            //     setFormData(newFormData);
            // };

            const handleInputChange = (field, value) => {
                // Assign User, Package Type, Package ID, Meal ‡¶ß‡¶æ‡¶∞‡¶æ‡¶¨‡¶æ‡¶π‡¶ø‡¶ï ‡¶π‡ßã‡¶ï ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á
                if (field === 'meal') {
                    const meal = meals.find(m => m.id === Number(value));
                    const mealPrice = meal ? meal.price : 0;
                    setFormData({
                        ...formData,
                        meal: Number(value),
                        price: mealPrice - (mealPrice * formData.discount) / 100
                    });
                }
                else if (field === 'discount') {
                    // ‡¶ü‡¶æ‡¶á‡¶™ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶´‡¶æ‡¶Å‡¶ï‡¶æ ‡¶Æ‡¶æ‡¶® ‡¶Ü‡¶≤‡¶æ‡¶â ‡¶ï‡¶∞‡ßÅ‡¶®
                    if (value === '') {
                        setFormData({
                            ...formData,
                            discount: '',
                            price: selectedMeal ? selectedMeal.price : 0
                        });
                        return;
                    }
                    // ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡ßü ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßá validate ‡¶ï‡¶∞‡ßÅ‡¶®
                    const num = Math.min(100, Math.max(0, parseFloat(value)));
                    const orig = selectedMeal ? selectedMeal.price : 0;
                    const discountAmt = (orig * num) / 100;
                    setFormData({
                        ...formData,
                        discount: num,
                        price: orig - discountAmt
                    });
                }
                else {
                    setFormData({
                        ...formData,
                        [field]: value
                    });
                }
            };

            const handleSubmit = () => {
                console.log('Form Data:', formData);
                alert('‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶è‡¶∏‡¶æ‡¶á‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
                handleClose();
            };

            const handleClose = () => {
                setOpen(false);
                // Reset form
                setFormData({
                    assignUser: 1,
                    packageType: '',
                    packageId: '',
                    meal: '',
                    discount: 0,
                    price: 0
                });
            };

            const isFormValid = formData.meal && formData.packageType && formData.packageId;

            return (
                <ThemeProvider theme={theme}>
                    <div>
                        <Card elevation={3} style={{ marginBottom: '20px', padding: '20px' }}>
                            <Typography variant="h4" gutterBottom align="center" color="primary">
                                üçΩÔ∏è ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶è‡¶∏‡¶æ‡¶á‡¶®‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ
                            </Typography>
                            <Typography variant="body1" align="center" color="textSecondary">
                                ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶è‡¶∏‡¶æ‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
                            </Typography>
                            <Box display="flex" justifyContent="center" mt={2}>
                                <Button
                                    variant="contained"
                                    color="primary"
                                    onClick={() => setOpen(true)}
                                    size="large"
                                    startIcon={<span className="material-icons">assignment</span>}
                                >
                                    ‡¶®‡¶§‡ßÅ‡¶® ‡¶è‡¶∏‡¶æ‡¶á‡¶®‡¶Æ‡ßá‡¶®‡ßç‡¶ü
                                </Button>
                            </Box>
                        </Card>

                        <Dialog
                            open={open}
                            onClose={handleClose}
                            maxWidth="lg"
                            fullWidth
                            PaperProps={{
                                elevation: 8,
                                style: { borderRadius: '12px' }
                            }}
                        >
                            <DialogTitle>
                                <Box display="flex" alignItems="center" gap={1}>
                                    <span className="material-icons" style={{ fontSize: '28px', color: '#1976d2' }}>
                                        restaurant_menu
                                    </span>
                                    <Typography variant="h5" component="div" style={{ fontWeight: 'bold' }}>
                                        ‡¶ñ‡¶æ‡¶¨‡¶æ‡¶∞ ‡¶è‡¶∏‡¶æ‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
                                    </Typography>
                                </Box>
                            </DialogTitle>

                            <DialogContent dividers>
                                <Grid container spacing={3} style={{ marginTop: '5px' }}>
                                    {/* Assign User */}
                                    <Grid item xs={12} md={6}>
                                        <FormControl fullWidth disabled>
                                            <InputLabel id="user-label">‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</InputLabel>
                                            <Select
                                                labelId="user-label"
                                                value={formData.assignUser}
                                                onChange={(e) => handleInputChange('assignUser', e.target.value)}
                                                label="‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®"
                                            >
                                                {sampleUsers.map(user => (
                                                    <MenuItem key={user.id} value={user.id}>
                                                        üë§ {user.name} ({user.email})
                                                    </MenuItem>
                                                ))}
                                            </Select>
                                        </FormControl>
                                    </Grid>

                                    {/* Package Type */}
                                    <Grid item xs={12} md={6}>
                                        <FormControl fullWidth>
                                            <InputLabel id="package-type-label">‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶ü‡¶æ‡¶á‡¶™</InputLabel>
                                            <Select
                                                labelId="package-type-label"
                                                value={formData.packageType}
                                                onChange={(e) => handleInputChange('packageType', e.target.value)}
                                                label="‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú ‡¶ü‡¶æ‡¶á‡¶™"
                                            >
                                                {packageTypes.map(pkg => (
                                                    <MenuItem key={pkg.id} value={pkg.id}>
                                                        üì¶ {pkg.name}
                                                    </MenuItem>
                                                ))}
                                            </Select>
                                        </FormControl>
                                    </Grid>

                                    {/* Package ID */}
                                    <Grid item xs={12} md={6}>
                                        <FormControl fullWidth>
                                            <InputLabel id="package-id-label">‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú</InputLabel>
                                            <Select
                                                labelId="package-id-label"
                                                value={formData.packageId}
                                                onChange={(e) => handleInputChange('packageId', e.target.value)}
                                                label="‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú"
                                            >
                                                {packageIds.map(pkg => (
                                                    <MenuItem key={pkg.id} value={pkg.id}>
                                                        üè∑Ô∏è {pkg.name}
                                                    </MenuItem>
                                                ))}
                                            </Select>
                                        </FormControl>
                                    </Grid>

                                    {/* Meal Selection */}
                                    <Grid item xs={12} md={6}>
                                        <FormControl fullWidth>
                                            <InputLabel id="meal-label">select full Day meal</InputLabel>
                                            <Select
                                                labelId="meal-label"
                                                value={formData.meal}
                                                onChange={(e) => handleInputChange('meal', e.target.value)}
                                                label="Select full day meal"
                                            >
                                                {meals.map(meal => (
                                                    <MenuItem key={meal.id} value={meal.id}>
                                                        üçΩÔ∏è {meal.name} - ‡ß≥{meal.price}
                                                    </MenuItem>
                                                ))}
                                            </Select>
                                        </FormControl>
                                    </Grid>

                                    {/* Discount */}
                                    <Grid item xs={12} md={6}>
                                        <TextField
                                            //     fullWidth
                                            //     label="‡¶õ‡¶æ‡¶°‡¶º (%)"
                                            //     type="number"
                                            //     value={formData.discount}
                                            //     onChange={(e) => handleInputChange('discount', Math.min(100, Math.max(0, parseFloat(e.target.value) || 0)))}
                                            //     inputProps={{ min: 0, max: 100, step: 0.1 }}
                                            //     helperText="‡ß¶ ‡¶•‡ßá‡¶ï‡ßá ‡ßß‡ß¶‡ß¶ ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßá‡¶®‡ßç‡¶ü"
                                            // />
                                            //<TextField
                                            fullWidth
                                            label="‡¶õ‡¶æ‡¶°‡¶º (%)"
                                            type="number"
                                            value={formData.discount}
                                            onChange={(e) => handleInputChange('discount', e.target.value)}  // <-- ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®
                                            inputProps={{ min: 0, max: 100, step: 0.1 }}
                                            helperText="‡ß¶ ‡¶•‡ßá‡¶ï‡ßá ‡ßß‡ß¶‡ß¶ ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßá‡¶®‡ßç‡¶ü"
                                        />
                                    </Grid>

                                    {/* Final Price */}
                                    <Grid item xs={12} md={6}>
                                        <TextField
                                            fullWidth
                                            label="‡¶ö‡ßÇ‡¶°‡¶º‡¶æ‡¶®‡ßç‡¶§ ‡¶¶‡¶æ‡¶Æ (‡ß≥)"
                                            type="number"
                                            value={finalPrice.toFixed(2)}
                                            disabled
                                            helperText="‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶ó‡¶£‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ"
                                        />
                                    </Grid>

                                    {/* Price Breakdown */}
                                    {selectedMeal && (
                                        <Grid item xs={12}>
                                            <Card elevation={3} className="price-breakdown">
                                                <CardContent>
                                                    <Box display="flex" alignItems="center" gap={1} mb={2}>
                                                        <span className="material-icons" style={{ color: '#1976d2' }}>
                                                            receipt_long
                                                        </span>
                                                        <Typography variant="h6" color="primary">
                                                            ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£
                                                        </Typography>
                                                    </Box>

                                                    <Grid container spacing={2}>
                                                        <Grid item xs={12} sm={6}>
                                                            <Box p={2} bgcolor="white" borderRadius={2} boxShadow={1}>
                                                                <Typography variant="subtitle1" style={{ fontWeight: 'bold' }} gutterBottom>
                                                                    üçΩÔ∏è {selectedMeal.name}
                                                                </Typography>
                                                                <Typography variant="body2" color="textSecondary">
                                                                    ‡¶Æ‡ßÇ‡¶≤ ‡¶¶‡¶æ‡¶Æ: ‡ß≥{originalPrice.toFixed(2)}
                                                                </Typography>
                                                                {formData.discount > 0 && (
                                                                    <Typography variant="body2" style={{ color: '#f44336' }}>
                                                                        ‡¶õ‡¶æ‡¶°‡¶º ({formData.discount}%): -‡ß≥{discountAmount.toFixed(2)}
                                                                    </Typography>
                                                                )}
                                                            </Box>
                                                        </Grid>

                                                        <Grid item xs={12} sm={6}>
                                                            <Box p={2} bgcolor="#e8f5e8" borderRadius={2} boxShadow={1}>
                                                                <Typography variant="h6" style={{ fontWeight: 'bold', color: '#2e7d32' }}>
                                                                    üí∞ ‡¶ö‡ßÇ‡¶°‡¶º‡¶æ‡¶®‡ßç‡¶§ ‡¶¶‡¶æ‡¶Æ: ‡ß≥{finalPrice.toFixed(2)}
                                                                </Typography>
                                                                {formData.discount > 0 && (
                                                                    <Typography variant="body2" style={{ color: '#2e7d32' }}>
                                                                        ‡¶Ü‡¶™‡¶®‡¶ø ‡ß≥{discountAmount.toFixed(2)} ‡¶∏‡¶æ‡¶∂‡ßç‡¶∞‡¶Ø‡¶º ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®!
                                                                    </Typography>
                                                                )}
                                                            </Box>
                                                        </Grid>
                                                    </Grid>
                                                </CardContent>
                                            </Card>
                                        </Grid>
                                    )}
                                </Grid>
                            </DialogContent>

                            <DialogActions style={{ padding: '16px 24px' }}>
                                <Button
                                    onClick={handleClose}
                                    color="secondary"
                                    startIcon={<span className="material-icons">cancel</span>}
                                >
                                    ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤
                                </Button>
                                <Button
                                    onClick={handleSubmit}
                                    color="primary"
                                    variant="contained"
                                    disabled={!isFormValid}
                                    startIcon={<span className="material-icons">check_circle</span>}
                                >
                                    ‡¶è‡¶∏‡¶æ‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
                                </Button>
                            </DialogActions>
                        </Dialog>
                    </div>
                </ThemeProvider>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<AssignModal />);
    </script>
</body>

</html>